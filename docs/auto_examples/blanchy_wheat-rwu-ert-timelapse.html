<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Monitoring of soil drying under winter wheat &mdash; Agrogeophy-notebooks 0.1.0 documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/example_gallery_styles.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Glossary" href="../glossary.html" />
    <link rel="prev" title="Inversion of current source density apply to a roots imaging" href="mary_run_nail.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Agrogeophy-notebooks<img src="../_static/CAGS.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting-started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Gallery of examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mary_run_nail.html">Inversion of current source density apply to a roots imaging</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Monitoring of soil drying under winter wheat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="#materials-and-methods">Materials and Methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#error-modelling">Error modelling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#results">Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Agrogeophy-notebooks</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Gallery of examples</a> &raquo;</li>
      <li>Monitoring of soil drying under winter wheat</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/blanchy_wheat-rwu-ert-timelapse.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="monitoring-of-soil-drying-under-winter-wheat">
<span id="gallery-auto-examples-blanchy-wheat-rwu-ert-timelapse-ipynb"></span><h1>Monitoring of soil drying under winter wheat<a class="headerlink" href="#monitoring-of-soil-drying-under-winter-wheat" title="Permalink to this headline">¶</a></h1>
<p>(updated on 2020-12-03)</p>
<p><strong>Author</strong>: Guillaume Blanchy
<a class="reference external" href="mailto:g&#46;blanchy&#37;&#52;&#48;lancaster&#46;ac&#46;uk">g<span>&#46;</span>blanchy<span>&#64;</span>lancaster<span>&#46;</span>ac<span>&#46;</span>uk</a> ✉️</p>
<p><strong>Reviewer</strong>: Benjamin Mary
<a class="reference external" href="mailto:benjamin&#46;mary&#37;&#52;&#48;unipd&#46;it">benjamin<span>&#46;</span>mary<span>&#64;</span>unipd<span>&#46;</span>it</a> ✉️</p>
<div class="section" id="context">
<h2>Context<a class="headerlink" href="#context" title="Permalink to this headline">¶</a></h2>
<p>To ensure our food security while This notebook shows how time-lapse
electrical resistivity tomography (ERT) can help to follow the soil
drying (mainly driven by root water uptake) during the growth season.
Geophysical tools has proven useful to monitor water movement in the
subsurface <a class="reference external" href="https://doi.org/10.1002/2015WR017016">(Binley et al.,
2015)</a>. From an agronomical
point of view, imaging the depth and extent of water drying by the roots
is a relevant traits for crop breeders to select new variety. Indeed, we
can expect that a crop able to take water deeper will be more resistant
to drought. Using time-lapse geophysics (ERT and FDEM), <a class="reference external" href="https://doi.org/10.2136/sssaj2014.09.0360">(Shanahan et
al., 2015)</a> were able to
image differences between a few winter wheat varieties.<a class="reference external" href="https://doi.org/10.1007/s11104-016-3161-1">(Whalley et
al., 2017)</a> further
expanded to larger number of varieties used and compared the geophysical
methods with other more traditional approaches (neutron probe,
penetrometer). However, field heterogeneity can, under some
circumstances, hinder the power of geophysics to rank the varieties.
This was investigated by <a class="reference external" href="https://doi.org/10.1002/vzj2.20037">(Blanchy et al.,
2020a)</a>. The data presented in
this notebook have been collected during this study.</p>
</div>
<div class="section" id="materials-and-methods">
<h2>Materials and Methods<a class="headerlink" href="#materials-and-methods" title="Permalink to this headline">¶</a></h2>
<p>This dataset was collected on 24 pins array (0.25 m electrode spacing)
using a dipole-dipole sequence with a Syscal Pro 48 (Iris Instruments,
Orléans, France). The experiment took place at <a class="reference external" href="https://www.google.com/maps/place/Woburn,+Milton+Keynes,+UK/&#64;52.017746,-0.5941597,490m/data=!3m1!1e3!4m5!3m4!1s0x487652e28c85f5dd:0x37055c5a77f68c64!8m2!3d51.987703!4d-0.6209209?hl=en">Worburn
(UK)</a>,
a research station managed by Rothamsted Research in 2017 under winter
wheat <a class="reference external" href="https://doi.org/10.1002/vzj2.20037">(Blanchy et al., 2020a)</a>.</p>
<p>Photo of one plot in February 2017.</p>
<p>The processing of the ERT data was done using
<a class="reference external" href="https://gitlab.com/hkex/resipy">ResIPy</a> Python API <a class="reference external" href="https://doi.org/10.1016/j.cageo.2020.104423">(Blanchy et al.,
2020b)</a> that is based
upon R* codes <a class="reference external" href="http://www.sciencedirect.com/science/article/pii/B9780444538024001925">(Binley,
2005)</a>.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">resipy</span> <span class="k">import</span> <span class="n">R2</span>
<span class="n">datadir</span> <span class="o">=</span> <span class="s1">&#39;../data/blanchy/dc-2d-timelapse/data/&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">API</span> <span class="n">path</span> <span class="o">=</span>  <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runner</span><span class="o">/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">resipy</span>
<span class="n">ResIPy</span> <span class="n">version</span> <span class="o">=</span>  <span class="mf">3.3</span><span class="o">.</span><span class="mi">3</span>
<span class="n">cR2</span><span class="o">.</span><span class="n">exe</span> <span class="ow">not</span> <span class="n">found</span><span class="p">,</span> <span class="n">will</span> <span class="n">download</span> <span class="n">it</span><span class="o">...</span><span class="n">done</span>
<span class="n">R3t</span><span class="o">.</span><span class="n">exe</span> <span class="ow">not</span> <span class="n">found</span><span class="p">,</span> <span class="n">will</span> <span class="n">download</span> <span class="n">it</span><span class="o">...</span><span class="n">done</span>
<span class="n">cR3t</span><span class="o">.</span><span class="n">exe</span> <span class="ow">not</span> <span class="n">found</span><span class="p">,</span> <span class="n">will</span> <span class="n">download</span> <span class="n">it</span><span class="o">...</span><span class="n">done</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="n">R2</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s1">&#39;R2&#39;</span><span class="p">)</span> <span class="c1"># initiate a Project instance for 2D DC survey (using R2 code)</span>
<span class="n">k</span><span class="o">.</span><span class="n">createTimeLapseSurvey</span><span class="p">([</span><span class="n">datadir</span> <span class="o">+</span> <span class="s1">&#39;17030207.csv&#39;</span><span class="p">,</span>
                         <span class="n">datadir</span> <span class="o">+</span> <span class="s1">&#39;17042705.csv&#39;</span><span class="p">,</span>
                         <span class="n">datadir</span> <span class="o">+</span> <span class="s1">&#39;17062304.csv&#39;</span><span class="p">],</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;Syscal&#39;</span><span class="p">)</span>
<span class="n">k</span><span class="o">.</span><span class="n">filterUnpaired</span><span class="p">()</span> <span class="c1"># remove dummy quadrupoles added to make dipole-dipole faster</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Working</span> <span class="n">directory</span> <span class="ow">is</span><span class="p">:</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">runner</span><span class="o">/.</span><span class="n">local</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="o">.</span><span class="mi">8</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">resipy</span>
<span class="mi">3</span><span class="o">/</span><span class="mi">3</span> <span class="n">imported</span>
<span class="n">removeUnpaired</span><span class="p">:</span><span class="n">removeUnpaired</span><span class="p">:</span><span class="n">removeUnpaired</span><span class="p">:</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">108</span>
</pre></div>
</div>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">k</span><span class="o">.</span><span class="n">showPseudo</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;(a) 2017-03-02&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">k</span><span class="o">.</span><span class="n">showPseudo</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;(b) 2017-04-27&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">k</span><span class="o">.</span><span class="n">showPseudo</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;(c) 2017-06-23&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;(c) 2017-06-23&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/blanchy_wheat-rwu-ert-timelapse_0.png" src="../_images/blanchy_wheat-rwu-ert-timelapse_0.png" />
<div class="section" id="error-modelling">
<h3>Error modelling<a class="headerlink" href="#error-modelling" title="Permalink to this headline">¶</a></h3>
<p>Inside the inversion routine, each measurement is given a weight related
to the error of the measurement. As the sequence used contains both
‘normal’ and ‘reciprocal’ quadrupoles, we can compute a reciprocal error
as: $ R_{error} = |R_{normal} - R_{reciprocal}| $. Using the mean
resistance measured as: $ R_{avg} =
<a href="#id1"><span class="problematic" id="id2">:raw-latex:`\frac{|R_{normal} + R_{reciprocal}|}{2}`$ we can fit a
power-law error model of the type :math:`R_{error} = a * R_{avg}^b`</span></a>.
This model is fitted in a logarithmic space (a power-law fit looks like
a linear fit in log space). To make the fit (red line) more robust,
measurements (blue plus) are grouped bins of which the mean is computed
(orange dots). This This is implemented in the method <code class="docutils literal notranslate"><span class="pre">fitErrorPwl()</span></code>
where the <code class="docutils literal notranslate"><span class="pre">index=-2</span></code> argument specifies that the model will be done on
the combined data of all surveys.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="o">.</span><span class="n">fitErrorPwl</span><span class="p">(</span><span class="n">index</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># fit a power-law error model for all dataset aggregated</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Error</span> <span class="n">model</span> <span class="ow">is</span> <span class="n">R_err</span> <span class="o">=</span> <span class="mf">0.008</span> <span class="n">R_avg</span><span class="o">^</span><span class="mf">1.036</span> <span class="p">(</span><span class="n">R</span><span class="o">^</span><span class="mi">2</span> <span class="o">=</span> <span class="mf">0.936</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/blanchy_wheat-rwu-ert-timelapse_1.png" src="../_images/blanchy_wheat-rwu-ert-timelapse_1.png" />
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="o">.</span><span class="n">createMesh</span><span class="p">(</span><span class="n">typ</span><span class="o">=</span><span class="s1">&#39;trian&#39;</span><span class="p">,</span> <span class="n">cl</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">cl_factor</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">show_output</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># create a triangular mesh with a characteristic length of 0.5</span>
<span class="n">k</span><span class="o">.</span><span class="n">showMesh</span><span class="p">()</span> <span class="c1"># display the mesh</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Creating</span> <span class="n">triangular</span> <span class="n">mesh</span><span class="o">...</span><span class="n">done</span> <span class="p">(</span><span class="mi">13273</span> <span class="n">elements</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/blanchy_wheat-rwu-ert-timelapse_2.png" src="../_images/blanchy_wheat-rwu-ert-timelapse_2.png" />
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">k</span><span class="o">.</span><span class="n">err</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">k</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># run the inversion (and write R2.in and protocol.dat automatically)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Writing</span> <span class="o">.</span><span class="ow">in</span> <span class="n">file</span> <span class="ow">and</span> <span class="n">protocol</span><span class="o">.</span><span class="n">dat</span><span class="o">...</span> <span class="n">Matching</span> <span class="n">quadrupoles</span> <span class="n">between</span> <span class="n">surveys</span> <span class="k">for</span> <span class="n">difference</span> <span class="n">inversion</span><span class="o">...</span><span class="mi">308</span> <span class="ow">in</span> <span class="n">common</span><span class="o">...</span><span class="n">done</span> <span class="ow">in</span> <span class="mf">0.012469</span><span class="n">s</span>
<span class="n">done</span>
<span class="o">------------</span> <span class="n">INVERTING</span> <span class="n">REFERENCE</span> <span class="n">SURVEY</span> <span class="o">---------------</span>


 <span class="o">&gt;&gt;</span> <span class="n">R</span>  <span class="mi">2</span>    <span class="n">R</span> <span class="n">e</span> <span class="n">s</span> <span class="n">i</span> <span class="n">s</span> <span class="n">t</span> <span class="n">i</span> <span class="n">v</span> <span class="n">i</span> <span class="n">t</span> <span class="n">y</span>   <span class="n">I</span> <span class="n">n</span> <span class="n">v</span> <span class="n">e</span> <span class="n">r</span> <span class="n">s</span> <span class="n">i</span> <span class="n">o</span> <span class="n">n</span>   <span class="n">v4</span><span class="o">.</span><span class="mi">02</span> <span class="o">&lt;&lt;</span>

 <span class="o">&gt;&gt;</span> <span class="n">D</span> <span class="n">a</span> <span class="n">t</span> <span class="n">e</span> <span class="p">:</span> <span class="mi">15</span> <span class="o">-</span> <span class="mi">03</span> <span class="o">-</span> <span class="mi">2022</span>
 <span class="o">&gt;&gt;</span> <span class="n">My</span> <span class="n">beautiful</span> <span class="n">survey</span>
 <span class="o">&gt;&gt;</span> <span class="n">I</span> <span class="n">n</span> <span class="n">v</span> <span class="n">e</span> <span class="n">r</span> <span class="n">s</span> <span class="n">e</span>   <span class="n">S</span> <span class="n">o</span> <span class="n">l</span> <span class="n">u</span> <span class="n">t</span> <span class="n">i</span> <span class="n">o</span> <span class="n">n</span>   <span class="n">S</span> <span class="n">e</span> <span class="n">l</span> <span class="n">e</span> <span class="n">c</span> <span class="n">t</span> <span class="n">e</span> <span class="n">d</span> <span class="o">&lt;&lt;</span>
 <span class="o">&gt;&gt;</span> <span class="n">Determining</span> <span class="n">storage</span> <span class="n">needed</span> <span class="k">for</span> <span class="n">finite</span> <span class="n">element</span> <span class="n">conductance</span> <span class="n">matrix</span>
 <span class="o">&gt;&gt;</span> <span class="n">Generating</span> <span class="n">index</span> <span class="n">array</span> <span class="k">for</span> <span class="n">finite</span> <span class="n">element</span> <span class="n">conductance</span> <span class="n">matrix</span>
 <span class="o">&gt;&gt;</span> <span class="n">Reading</span> <span class="n">start</span> <span class="n">resistivity</span> <span class="kn">from</span> <span class="nn">res0.dat</span>
 <span class="o">&gt;&gt;</span> <span class="n">R</span> <span class="n">e</span> <span class="n">g</span> <span class="n">u</span> <span class="n">l</span> <span class="n">a</span> <span class="n">r</span> <span class="n">i</span> <span class="n">s</span> <span class="n">e</span> <span class="n">d</span>   <span class="n">T</span> <span class="n">y</span> <span class="n">p</span> <span class="n">e</span> <span class="o">&lt;&lt;</span>
 <span class="o">&gt;&gt;</span>   <span class="n">L</span> <span class="n">i</span> <span class="n">n</span> <span class="n">e</span> <span class="n">a</span> <span class="n">r</span>    <span class="n">F</span> <span class="n">i</span> <span class="n">l</span> <span class="n">t</span> <span class="n">e</span> <span class="n">r</span>    <span class="o">&lt;&lt;</span>
 <span class="o">&gt;&gt;</span> <span class="n">L</span> <span class="n">o</span> <span class="n">g</span> <span class="o">-</span> <span class="n">D</span> <span class="n">a</span> <span class="n">t</span> <span class="n">a</span>   <span class="n">I</span> <span class="n">n</span> <span class="n">v</span> <span class="n">e</span> <span class="n">r</span> <span class="n">s</span> <span class="n">i</span> <span class="n">o</span> <span class="n">n</span> <span class="o">&lt;&lt;</span>
 <span class="o">&gt;&gt;</span> <span class="n">N</span> <span class="n">o</span> <span class="n">r</span> <span class="n">m</span> <span class="n">a</span> <span class="n">l</span>   <span class="n">R</span> <span class="n">e</span> <span class="n">g</span> <span class="n">u</span> <span class="n">l</span> <span class="n">a</span> <span class="n">r</span> <span class="n">i</span> <span class="n">s</span> <span class="n">a</span> <span class="n">t</span> <span class="n">i</span> <span class="n">o</span> <span class="n">n</span> <span class="o">&lt;&lt;</span>
 <span class="o">&gt;&gt;</span> <span class="n">D</span> <span class="n">a</span> <span class="n">t</span> <span class="n">a</span>   <span class="n">w</span> <span class="n">e</span> <span class="n">i</span> <span class="n">g</span> <span class="n">h</span> <span class="n">t</span> <span class="n">s</span>   <span class="n">w</span> <span class="n">i</span> <span class="n">l</span> <span class="n">l</span>   <span class="n">b</span> <span class="n">e</span>  <span class="n">m</span> <span class="n">o</span> <span class="n">d</span> <span class="n">i</span> <span class="n">f</span> <span class="n">i</span> <span class="n">e</span> <span class="n">d</span> <span class="o">&lt;&lt;</span>


 <span class="n">Processing</span> <span class="n">dataset</span>   <span class="mi">1</span>


 <span class="n">Measurements</span> <span class="n">read</span><span class="p">:</span>   <span class="mi">154</span>     <span class="n">Measurements</span> <span class="n">rejected</span><span class="p">:</span>     <span class="mi">0</span>
   <span class="n">Geometric</span> <span class="n">mean</span> <span class="n">of</span> <span class="n">apparent</span> <span class="n">resistivities</span><span class="p">:</span>  <span class="mf">0.74009E+02</span>

 <span class="o">&gt;&gt;</span> <span class="n">Total</span> <span class="n">Memory</span> <span class="n">required</span> <span class="ow">is</span><span class="p">:</span>          <span class="mf">0.800</span> <span class="n">Gb</span>

   <span class="n">Iteration</span>   <span class="mi">1</span>
     <span class="n">Initial</span> <span class="n">RMS</span> <span class="n">Misfit</span><span class="p">:</span>        <span class="mf">20.17</span>       <span class="n">Number</span> <span class="n">of</span> <span class="n">data</span> <span class="n">ignored</span><span class="p">:</span>     <span class="mi">0</span>
     <span class="n">Alpha</span><span class="p">:</span>           <span class="mf">4.945</span>   <span class="n">RMS</span> <span class="n">Misfit</span><span class="p">:</span>        <span class="mf">2.80</span>  <span class="n">Roughness</span><span class="p">:</span>       <span class="mf">14.291</span>
     <span class="n">Alpha</span><span class="p">:</span>           <span class="mf">2.295</span>   <span class="n">RMS</span> <span class="n">Misfit</span><span class="p">:</span>        <span class="mf">3.09</span>  <span class="n">Roughness</span><span class="p">:</span>       <span class="mf">17.010</span>
     <span class="n">Step</span> <span class="n">length</span> <span class="nb">set</span> <span class="n">to</span>   <span class="mf">1.00000</span>
     <span class="n">Final</span> <span class="n">RMS</span> <span class="n">Misfit</span><span class="p">:</span>        <span class="mf">2.80</span>
     <span class="n">Updated</span> <span class="n">data</span> <span class="n">weights</span>

   <span class="n">Iteration</span>   <span class="mi">2</span>
     <span class="n">Initial</span> <span class="n">RMS</span> <span class="n">Misfit</span><span class="p">:</span>         <span class="mf">2.35</span>       <span class="n">Number</span> <span class="n">of</span> <span class="n">data</span> <span class="n">ignored</span><span class="p">:</span>     <span class="mi">0</span>
     <span class="n">Alpha</span><span class="p">:</span>           <span class="mf">2.874</span>   <span class="n">RMS</span> <span class="n">Misfit</span><span class="p">:</span>        <span class="mf">0.45</span>  <span class="n">Roughness</span><span class="p">:</span>       <span class="mf">23.711</span>
     <span class="n">Step</span> <span class="n">length</span> <span class="nb">set</span> <span class="n">to</span>   <span class="mf">1.00000</span>
     <span class="n">Final</span> <span class="n">RMS</span> <span class="n">Misfit</span><span class="p">:</span>        <span class="mf">0.45</span>
     <span class="n">Final</span> <span class="n">RMS</span> <span class="n">Misfit</span><span class="p">:</span>        <span class="mf">1.01</span>

 <span class="n">Solution</span> <span class="n">converged</span> <span class="o">-</span> <span class="n">Outputing</span> <span class="n">results</span> <span class="n">to</span> <span class="n">file</span>

 <span class="n">Calculating</span> <span class="n">sensitivity</span> <span class="nb">map</span>


 <span class="n">Processing</span> <span class="n">dataset</span>   <span class="mi">2</span>


 <span class="n">End</span> <span class="n">of</span> <span class="n">data</span><span class="p">:</span>  <span class="n">Terminating</span>

<span class="o">---------------------</span> <span class="n">MAIN</span> <span class="n">INVERSION</span> <span class="o">------------------</span>
<span class="n">________________System</span><span class="o">-</span><span class="n">Check__________________</span>
<span class="n">Kernel</span> <span class="nb">type</span><span class="p">:</span> <span class="n">Linux</span>
<span class="n">Processor</span> <span class="n">info</span><span class="p">:</span> <span class="n">x86_64</span>
<span class="mi">2</span> <span class="n">Threads</span> <span class="n">at</span> <span class="o">&lt;=</span> <span class="mf">2397.2</span> <span class="n">Mhz</span>
<span class="n">Total</span> <span class="n">memory</span> <span class="o">=</span> <span class="mf">6.8</span> <span class="n">Gb</span> <span class="p">(</span><span class="n">usage</span> <span class="o">=</span> <span class="mf">15.1</span><span class="p">)</span>
<span class="n">Wine</span> <span class="n">version</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">GPU</span> <span class="n">info</span><span class="p">:</span> <span class="kc">None</span>
<span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="n">inversions</span> <span class="n">completed</span>
<span class="o">-----------</span> <span class="n">END</span> <span class="n">OF</span> <span class="n">INVERSION</span> <span class="n">IN</span> <span class="o">//</span> <span class="o">----------</span>
<span class="mi">3</span><span class="o">/</span><span class="mi">3</span> <span class="n">results</span> <span class="n">parsed</span> <span class="p">(</span><span class="mi">3</span> <span class="n">ok</span><span class="p">;</span> <span class="mi">0</span> <span class="n">failed</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>By comparing the relative difference in resistivity
(<span class="math notranslate nohighlight">\(\frac{\Delta \rho}{\rho_{March}}\)</span> in %) between (a) March-April
and (b) March-May. We can observe larger and deeper soil increase of
resistivity associated with larger soil drying from plants water uptake.</p>
<div class="code ipython3 highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;(a) 2nd March to 27th April&#39;</span><span class="p">)</span>
<span class="n">k</span><span class="o">.</span><span class="n">showResults</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;difference(percent)&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;(b) 2nd March to 23rd May&#39;</span><span class="p">)</span>
<span class="n">k</span><span class="o">.</span><span class="n">showResults</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">attr</span><span class="o">=</span><span class="s1">&#39;difference(percent)&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">contour</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/blanchy_wheat-rwu-ert-timelapse_3.png" src="../_images/blanchy_wheat-rwu-ert-timelapse_3.png" />
<div class="sphx-glr-download docutils container">
<p><strong>Download python script:</strong> <a class="reference download internal" download="" href="../_downloads/814d6f91264b0dc395d9a2758aa9962e/blanchy_wheat-rwu-ert-timelapse.py"><code class="xref download docutils literal notranslate"><span class="pre">blanchy_wheat-rwu-ert-timelapse.py</span></code></a></p>
<p><strong>Download Jupyter notebook:</strong> <a class="reference download internal" download="" href="../_downloads/0363e4de81d7bf14b0568a64e4707aa3/blanchy_wheat-rwu-ert-timelapse.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">blanchy_wheat-rwu-ert-timelapse.ipynb</span></code></a></p>
<p><strong>View the notebook in the</strong> <a class="reference external" href="https://nbviewer.jupyter.org/github/agrogeophy/notebooks/blob/master/notebooks/blanchy_wheat-rwu-ert-timelapse.ipynb">Jupyter nbviewer</a></p>
<p><strong>Run this example interactively:</strong> <a class="reference external" href="https://mybinder.org/v2/gh/agrogeophy/notebooks/master?filepath=notebooks/blanchy_wheat-rwu-ert-timelapse.ipynb"><img alt="binder" src="https://mybinder.org/badge_logo.svg" /></a></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mary_run_nail.html" class="btn btn-neutral float-left" title="Inversion of current source density apply to a roots imaging" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../glossary.html" class="btn btn-neutral float-right" title="Glossary" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MIT License.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>